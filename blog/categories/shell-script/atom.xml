<?xml version="1.0" encoding="utf-8"?>
<feed xmlns="http://www.w3.org/2005/Atom">

  <title><![CDATA[Category: Shell Script | My code works, I don't know why.]]></title>
  <link href="http://wen00072.github.io/blog/categories/shell-script/atom.xml" rel="self"/>
  <link href="http://wen00072.github.io/"/>
  <updated>2016-08-06T01:50:35+08:00</updated>
  <id>http://wen00072.github.io/</id>
  <author>
    <name><![CDATA[Wen Liao]]></name>
    
  </author>
  <generator uri="http://octopress.org/">Octopress</generator>

  
  <entry>
    <title type="html"><![CDATA[Auto Photo Watermarking Script]]></title>
    <link href="http://wen00072.github.io/blog/2016/08/02/auto-photo-watermarking-script/"/>
    <updated>2016-08-02T16:53:13+08:00</updated>
    <id>http://wen00072.github.io/blog/2016/08/02/auto-photo-watermarking-script</id>
    <content type="html"><![CDATA[<p>因故需要對大量圖片調整解析度並加入浮水印，查了網路找到非常好的<a href="http://www.linuxjournal.com/content/easy-watermarking-imagemagick">範例文章</a>。這篇<a href="http://www.linuxjournal.com/content/easy-watermarking-imagemagick">文章</a>裏面也有script，和我的不太一樣，有興趣的人可以去參考。</p>

<p>更改後寫成script如下，它做了：</p>

<ol>
<li>開了<code>processed_pictures</code>目錄，把改過的檔案存到該目錄</li>
<li>將新的圖案解析度寬度轉成1024</li>
<li>將產生的圖片quality設成80%</li>
<li>加入浮水印字串</li>
</ol>


<pre><code class="bash">#!/bin/sh
TARGET_DIR=processed_pictures
NEW_WIDTH=1024
CAP="Wen Liao"

mkdir -p $TARGET_DIR
for i in $(ls) ; do
    echo convert $i to $TARGET_DIR
    convert -background '#0008' -quality 80 -resize $NEW_WIDTH -fill white -gravity center -size $(identify -format %w $i)x120 caption:"$CAP" $i +swap -gravity south -composite $TARGET_DIR/$i
done
</code></pre>

<p>要注意</p>

<ol>
<li>本script假設目前目錄都是圖檔，所以不判斷檔名是否為<code>.jpg</code>或是<code>.png</code></li>
<li>無法處理檔名有空白的檔案</li>
<li>你需要自行安裝imagemagick</li>
<li>由於相片landscape 和 portrait的關係，浮水印的位址不一定會和你想的一樣，目前為止我不在意這個問題就是了。附上範例轉出的landscape 和 portrait照片各一張</li>
</ol>


<h4>Landscape</h4>

<p><img src="http://wen00072.github.io/files/dog.jpg" title="landscape"></p>

<h4>Portrait</h4>

<p><img src="http://wen00072.github.io/files/cat.jpg" title="portrait"></p>

<h2>參考資料</h2>

<ul>
<li><a href="http://www.linuxjournal.com/content/easy-watermarking-imagemagick">Linux Journal Easy Watermarking with ImageMagick</a></li>
<li><a href="http://www.xoogu.com/2013/how-to-automatically-watermark-or-batch-watermark-photos-using-imagemagick/">How to automatically watermark or batch watermark photos using ImageMagick</a></li>
</ul>

]]></content>
  </entry>
  
</feed>
